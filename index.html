  <!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>سالنامه علمی تبیان - حوزه علمیه امام صادق (ع) جیرفت</title>
  <meta name="description" content="سالنامه علمی تبیان، نشریه تخصصی در زمینه علوم حوزوی و اسلامی، منتشر شده توسط حوزه علمیه امام صادق علیه السلام جیرفت. دارای رتبه علمی اطلاع رسانی.">
  <meta name="keywords" content="سالنامه علمی تبیان, حوزه علمیه امام صادق جیرفت, علوم حوزوی, علوم اسلامی, مقالات علمی, حجت الاسلام شهدادنژاد, حجت الاسلام پرموده, جیرفت, نشریه علمی">
  <meta name="author" content="حوزه علمیه امام صادق علیه السلام جیرفت">
  <meta name="owner" content="حوزه علمیه امام صادق علیه السلام جیرفت">
  <meta name="publisher" content="حوزه علمیه امام صادق علیه السلام جیرفت">
  <meta name="robots" content="index, follow">
  <link rel="canonical" href="https://SciTebyan.ir/">

  <meta name="google-site-verification" content="MY_GOOGLE_SITE_VERIFICATION_TOKEN">

  <meta property="og:type" content="website">
  <meta property="og:url" content="https://SciTebyan.ir/">
  <meta property="og:title" content="سالنامه علمی تبیان - حوزه علمیه امام صادق (ع) جیرفت">
  <meta property="og:description" content="سالنامه علمی تبیان، نشریه تخصصی در زمینه علوم حوزوی و اسلامی. مقالات پذیرفته شده طلاب سطوح حوزه علمیه امام صادق (ع) جیرفت.">
  <meta property="og:image" content="https://SciTebyan.ir/cover-image.png">
  <meta property="og:site_name" content="سالنامه علمی تبیان">
  <meta property="og:locale" content="fa_IR">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:url" content="https://SciTebyan.ir/">
  <meta name="twitter:title" content="سالنامه علمی تبیان - حوزه علمیه امام صادق (ع) جیرفت">
  <meta name="twitter:description" content="سالنامه علمی تبیان، نشریه تخصصی در زمینه علوم حوزوی و اسلامی. مقالات پذیرفته شده طلاب سطوح حوزه علمیه امام صادق (ع) جیرفت.">
  <meta name="twitter:image" content="https://SciTebyan.ir/cover-image.png">

  <link rel="icon" href="/favicon.ico" type="image/x-icon">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  <meta name="theme-color" content="#003366">

  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "url": "https://SciTebyan.ir/",
    "name": "سالنامه علمی تبیان",
    "description": "سالنامه علمی تبیان، نشریه تخصصی در زمینه علوم حوزوی و اسلامی، منتشر شده توسط حوزه علمیه امام صادق علیه السلام جیرفت.",
    "publisher": {
      "@type": "Organization",
      "name": "حوزه علمیه امام صادق علیه السلام جیرفت",
      "url": "https://SciTebyan.ir/",
      "logo": "https://SciTebyan.ir/logo-organization.png"
    },
    "potentialAction": {
      "@type": "SearchAction",
      "target": "https://SciTebyan.ir/?q={search_term_string}",
      "query-input": "required name=search_term_string"
    }
  }
  </script>
  <meta name="citation_journal_title" content="سالنامه علمی تبیان">
  <meta name="citation_publisher" content="حوزه علمیه امام صادق علیه السلام جیرفت">

  <link rel="preconnect" href="https://www.googletagmanager.com">
  <script async src="https://www.googletagmanager.com/gtag/js?id=YOUR_GA_ID_HERE"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){ dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'YOUR_GA_ID_HERE');
  </script>

  <style>
    @font-face {
      font-family: 'BNazaninCustom';
      src: url('https://tashacol.github.io/ir/B-NAZANIN.TTF') format('truetype');
      font-weight: normal;
      font-style: normal;
      font-display: swap;
    }

    :root {
      --primary-color: #003366;
      --secondary-color: #0055A4;
      --accent-color: #D4AF37;
      --text-color: #333333;
      --light-text-color: #f8f9fa;
      --bg-color: #f8f9fa;
      --card-bg-color: #ffffff;
      --border-color: #dee2e6;
      --font-family: 'BNazaninCustom', Tahoma, Arial, sans-serif;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    #loading-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: var(--bg-color);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      flex-direction: column;
      transition: opacity 0.5s ease-out, visibility 0.5s ease-out;
    }
    .loader {
      border: 8px solid #f3f3f3;
      border-top: 8px solid var(--secondary-color);
      border-radius: 50%;
      width: 60px;
      height: 60px;
      animation: spin 1.5s linear infinite;
    }
    #loading-overlay p {
        margin-top: 20px;
        font-size: 1.2rem;
        color: var(--text-color);
        font-family: var(--font-family);
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .hidden-until-ready {
        opacity: 0;
        visibility: hidden;
    }
    .page-wrapper.visible {
        opacity: 1;
        visibility: visible;
        transition: opacity 0.5s ease-in;
    }

    body {
      font-family: var(--font-family);
      background-color: var(--bg-color);
      color: var(--text-color);
      line-height: 1.7;
      font-size: 17px;
    }

    a {
      text-decoration: none;
      color: var(--secondary-color);
    }
    a:hover {
      color: var(--primary-color);
      text-decoration: underline;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
    }

    .site-header {
      background-color: var(--primary-color);
      color: var(--light-text-color);
      padding: 20px 0;
      text-align: center;
      border-bottom: 5px solid var(--accent-color);
    }
    .site-header h1 {
      font-size: 2.5rem;
      margin-bottom: 5px;
      font-weight: bold;
    }
    .site-header .subtitle {
      font-size: 1.1rem;
      opacity: 0.9;
    }

    .main-nav {
      background-color: var(--secondary-color);
      padding: 10px 0;
    }
    .main-nav ul {
      list-style: none;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-wrap: wrap;
    }
    .main-nav li {
      margin: 5px 15px;
    }
    .main-nav a {
      color: var(--light-text-color);
      font-weight: bold;
      padding: 8px 12px;
      border-radius: 4px;
      transition: background-color 0.3s ease;
    }
    .main-nav a:hover, .main-nav a.active {
      background-color: var(--primary-color);
      text-decoration: none;
    }

    .main-content {
      padding: 30px 0;
    }

    #search-bar {
      width: 100%;
      padding: 12px 15px;
      margin-bottom: 30px;
      border: 1px solid var(--border-color);
      border-radius: 5px;
      font-size: 1rem;
      font-family: var(--font-family);
    }
    #search-bar:focus {
        outline: none;
        border-color: var(--secondary-color);
        box-shadow: 0 0 0 0.2rem rgba(0, 85, 164, 0.25);
    }

    .articles-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 25px;
    }

    .article-card {
      background-color: var(--card-bg-color);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      padding: 20px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
      transition: box-shadow 0.3s ease;
    }
    .article-card:hover {
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    .article-title {
      font-size: 1.6rem;
      font-weight: bold;
      color: var(--primary-color);
      margin-bottom: 10px;
    }
    .article-meta {
      font-size: 0.9rem;
      color: #6c757d;
      margin-bottom: 15px;
    }
    .article-meta span { margin-left: 15px; display: inline-block; margin-bottom: 5px;}
    .article-meta strong { color: var(--text-color); font-weight: bold; }

    .article-abstract {
      font-size: 1rem;
      color: #495057;
      margin-bottom: 15px;
      line-height: 1.8;
      max-height: 110px;
      overflow: hidden;
      text-overflow: ellipsis;
    }
     .article-abstract.expanded {
      max-height: none;
    }

    .read-more-abstract, .show-less-abstract {
        color: var(--secondary-color);
        cursor: pointer;
        font-size: 0.9rem;
        display: inline-block;
        margin-bottom:15px;
        font-weight: bold;
    }
    .read-more-abstract:hover, .show-less-abstract:hover {
        text-decoration: underline;
    }

    .article-keywords {
        font-size: 0.9rem;
        margin-bottom: 20px;
    }
    .article-keywords strong { color: var(--text-color); font-weight: bold;}
    .article-keywords span {
        background-color: #e9ecef;
        color: #495057;
        padding: 3px 8px;
        border-radius: 4px;
        margin-left: 5px;
        font-size: 0.85rem;
        display: inline-block;
        margin-bottom: 5px;
    }

    .download-button {
      display: inline-block;
      background-color: var(--secondary-color);
      color: var(--light-text-color);
      padding: 10px 20px;
      border-radius: 5px;
      font-weight: bold;
      text-align: center;
      transition: background-color 0.3s ease;
      font-size: 0.95rem;
    }
    .download-button:hover {
      background-color: var(--primary-color);
      color: var(--light-text-color);
      text-decoration: none;
    }
    .download-button.small {
        padding: 6px 12px;
        font-size: 0.85rem;
    }

    .modal-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.7);
      align-items: center;
      justify-content: center;
      z-index: 1000;
      padding: 20px;
      opacity: 0;
      transition: opacity 0.3s ease-in-out;
    }
    .modal-overlay.visible {
        display: flex;
        opacity: 1;
    }
    .modal-content {
      background: var(--card-bg-color);
      padding: 30px;
      border-radius: 8px;
      max-width: 700px;
      width: 100%;
      box-shadow: 0 5px 15px rgba(0,0,0,0.3);
      max-height: 90vh;
      overflow-y: auto;
      font-family: var(--font-family);
      transform: scale(0.95);
      transition: transform 0.3s ease-in-out;
      position: relative;
    }
    .modal-overlay.visible .modal-content {
        transform: scale(1);
    }

    .modal-content h2 {
      color: var(--primary-color);
      margin-bottom: 20px;
      text-align: center;
      font-size: 1.8rem;
      font-weight: bold;
    }
    .modal-content p {
      margin-bottom: 12px;
      line-height: 1.8;
    }
    .modal-content strong {
      color: var(--text-color);
      font-weight: bold;
    }
    .modal-content ul {
      list-style: disc;
      margin-right: 20px;
      margin-bottom: 15px;
    }
    .modal-content .info-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 15px;
        margin-bottom: 20px;
    }
    .modal-content .info-item {
        background-color: #f8f9fa;
        padding: 10px;
        border-radius: 4px;
        border-right: 3px solid var(--secondary-color);
    }

    #issues-table-container table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
    }
    #issues-table-container th,
    #issues-table-container td {
        border: 1px solid var(--border-color);
        padding: 10px;
        text-align: right;
    }
    #issues-table-container th {
        background-color: #e9ecef;
        font-weight: bold;
        color: var(--primary-color);
    }
    #issues-table-container td a.download-button {
        margin: 0 auto;
    }

    #cover-modal .modal-content {
        max-width: 500px;
        padding: 20px;
        text-align: center;
    }
    #cover-image-display {
        max-width: 100%;
        max-height: 60vh;
        border: 2px solid var(--border-color);
        border-radius: 4px;
        cursor: zoom-in;
        transition: transform 0.3s ease, max-height 0.3s ease;
        object-fit: contain;
    }
    #cover-image-display.zoomed {
        max-height: 85vh;
        transform: scale(1.1);
        cursor: zoom-out;
        box-shadow: 0 5px 20px rgba(0,0,0,0.3);
    }
    #cover-modal-text {
        margin-top: 15px;
        font-size: 0.95rem;
        color: var(--text-color);
    }
    .modal-close-button {
        position: absolute;
        top: -10px;
        left: -10px;
        background: var(--primary-color);
        color: white;
        border: 2px solid white;
        border-radius: 50%;
        width: 35px;
        height: 35px;
        font-size: 20px;
        line-height: 32px;
        text-align: center;
        cursor: pointer;
        box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        transition: transform 0.2s ease, background-color 0.2s ease;
        font-weight: bold;
    }
    .modal-close-button:hover {
        background-color: var(--secondary-color);
        transform: scale(1.1);
    }

    .site-footer {
      background-color: #343a40;
      color: #adb5bd;
      text-align: center;
      padding: 25px 0;
      margin-top: 40px;
      font-size: 0.9rem;
    }
    .site-footer p { margin-bottom: 5px; }
    .site-footer a { color: #ced4da; }
    .site-footer a:hover { color: var(--light-text-color); }

    @media (max-width: 768px) {
      .site-header h1 { font-size: 2rem; }
      .site-header .subtitle { font-size: 1rem; }
      .modal-content { padding: 20px; }
      .modal-content h2 { font-size: 1.5rem; }
      #issues-table-container th,
      #issues-table-container td {
          padding: 8px;
          font-size: 0.9rem;
      }
      #issues-table-container td a.download-button {
          font-size: 0.8rem;
          padding: 5px 10px;
      }
      #cover-modal .modal-content { max-width: 90vw; }
      .modal-close-button { top: 5px; left: 5px; width:30px; height:30px; font-size:18px; line-height:28px;}
    }
    @media (max-width: 480px) {
        .article-title { font-size: 1.3rem; }
        .article-meta, .article-abstract, .article-keywords { font-size: 0.85rem; }
    }
  </style>
</head>
<body>

  <div id="loading-overlay">
    <div class="loader"></div>
    <p>در حال بارگذاری، لطفا شکیبا باشید...</p>
  </div>

  <div id="page-wrapper" class="hidden-until-ready">
    <header class="site-header">
      <div class="container">
        <h1>سالنامه علمی تبیان</h1>
        <p class="subtitle">حوزه علمیه امام صادق علیه السلام جیرفت</p>
      </div>
    </header>

    <nav class="main-nav">
      <div class="container">
        <ul>
          <li><a href="#" class="active" onclick="event.preventDefault();">صفحه مقالات</a></li>
          <li><a href="#" onclick="event.preventDefault(); toggleJournalInfo(true);">درباره نشریه</a></li>
          <li><a href="#" onclick="event.preventDefault(); toggleIssuesModal(true);">مشاهده دوره‌ها</a></li>
          <li><a href="#" onclick="event.preventDefault(); toggleJournalInfo(true, 'contact');">اطلاعات تماس</a></li>
        </ul>
      </div>
    </nav>

    <main class="main-content">
      <div class="container">
        <input type="text" id="search-bar" placeholder="جستجو در عنوان، نویسندگان یا کلیدواژه‌های مقالات...">
        <div id="articles-container" class="articles-grid">
          <!-- محتوای مقالات توسط جاوااسکریپت اینجا بارگذاری می‌شود -->
        </div>
      </div>
    </main>

    <footer class="site-footer">
      <div class="container">
        <p>© تمامی حقوق این وب‌سایت متعلق به <strong>سالنامه علمی تبیان</strong>، حوزه علمیه امام صادق علیه السلام جیرفت می‌باشد.</p>
        <p>آدرس سایت: <a href="https://SciTebyan.ir" target="_blank">SciTebyan.ir</a></p>
      </div>
    </footer>
  </div>


  <div id="journal-info-modal" class="modal-overlay">
    <div class="modal-content">
       <button class="modal-close-button" onclick="toggleJournalInfo(false)" title="بستن">×</button>
      <h2 id="modal-title-info">درباره سالنامه علمی تبیان</h2>
      <div id="modal-section-about">
        <p><strong>سالنامه علمی تبیان</strong> یک نشریه تخصصی در زمینه علوم حوزوی و اسلامی است که توسط <strong>حوزه علمیه امام صادق علیه السلام جیرفت</strong> منتشر می‌شود. این سالنامه با هدف ترویج و نشر پژوهش‌های علمی طلاب و فضلای حوزه، به ویژه طلاب سطوح حوزه علمیه امام صادق (ع) جیرفت که مقالاتشان پس از طی فرآیند داوری علمی پذیرفته شده باشد، فعالیت می‌کند.</p>
        <div class="info-grid">
            <div class="info-item"><strong>صاحب امتیاز:</strong> حوزه علمیه امام صادق علیه السلام جیرفت</div>
            <div class="info-item"><strong>مدیر مسئول:</strong> حجت الاسلام شهدادنژاد</div>
            <div class="info-item"><strong>سردبیر:</strong> حجت الاسلام پرموده</div>
            <div class="info-item"><strong>مجوز:</strong> دارای مجوز از شورای حوزه علمیه استان کرمان</div>
            <div class="info-item"><strong>رتبه علمی:</strong> علمی - اطلاع رسانی</div>
            <div class="info-item"><strong>زمینه تخصصی:</strong> علوم حوزوی و اسلامی</div>
            <div class="info-item"><strong>دوره نشر:</strong> سالانه (انتشار در ۱۰ خرداد هر سال)</div>
            <div class="info-item"><strong>نمایه‌سازی:</strong> تلاش برای نمایه شدن در سیویلیکا</div>
        </div>
        <p><strong>شرایط پذیرش مقاله:</strong></p>
        <ul>
          <li>مقالات باید در زمینه علوم حوزوی، اسلامی باشند</li>
          <li>نویسندگان باید از طلاب سطوح حوزه علمیه امام صادق (ع) جیرفت باشند.</li>
          <li>مقالات باید اصیل بوده و قبلاً در جای دیگری منتشر نشده باشند.</li>
          <li>مقالات پس از ارسال، توسط داوران متخصص بررسی و در صورت تایید، پذیرفته خواهند شد.</li>
        </ul>
      </div>
      <div id="modal-section-contact" style="display:none;">
        <p><strong>آدرس دفتر نشریه:</strong></p>
        <p>استان کرمان، شهرستان جیرفت، بلوار امام خمینی، ابتدای خیابان انقلاب، حوزه علمیه امام صادق علیه السلام.</p>
        <p><strong>آدرس وب‌سایت:</strong> <a href="https://SciTebyan.ir" target="_blank">SciTebyan.ir</a></p>
        <p><strong>پست الکترونیکی:</strong> <a href="mailto:SciTebyan@gmail.com">SciTebyan@gmail.com</a></p>
        <p><strong>تلفن تماس:</strong>۰۳۴۴۳۳۱۶۰۲۵ </p>
      </div>
    </div>
  </div>

  <div id="journal-issues-modal" class="modal-overlay">
    <div class="modal-content">
      <button class="modal-close-button" onclick="toggleIssuesModal(false)" title="بستن">×</button>
      <h2>دوره‌های منتشر شده سالنامه</h2>
      <div id="issues-table-container">
        <p style="text-align:center;">در حال بارگذاری اطلاعات دوره‌ها...</p>
      </div>
    </div>
  </div>

  <div id="cover-modal" class="modal-overlay">
    <div class="modal-content">
      <button class="modal-close-button" onclick="toggleCoverModal(false)" title="بستن">×</button>
      <img id="cover-image-display" src="" alt="جلد آخرین دوره سالنامه تبیان">
      <p id="cover-modal-text">برای دانلود کامل این دوره و دوره‌های پیشین، از طریق منوی "مشاهده دوره‌ها" اقدام نمایید.</p>
    </div>
  </div>


  <script>
    const articlesSheetId = '1Kf49GtmSZbX2Or8dgzqarq5MVxSnv17jRPNPxeLL_wk';
    const issuesSheetId = '15nuHXnC40udicxyaiiZcsagZVVrss8LXPhK3FOwfI_c';

    // <<-- مهم: لینک مستقیم به تصویر جلد آخرین دوره را اینجا قرار دهید
    const latestCoverImageUrl = 'https://tashacol.github.io/Dadgostar/IMG_۲۰۲۵۰۵۱۹_۲۲۴۱۱۳.png'; // مثال: 'https://example.com/covers/latest-issue.jpg'
    const showCoverModalOnLoad = true;

    const articlesContainer = document.getElementById('articles-container');
    const searchInput = document.getElementById('search-bar');
    const loadingOverlay = document.getElementById('loading-overlay');
    const pageWrapper = document.getElementById('page-wrapper');
    const journalInfoModal = document.getElementById('journal-info-modal');
    const modalTitleInfo = document.getElementById('modal-title-info');
    const modalSectionAbout = document.getElementById('modal-section-about');
    const modalSectionContact = document.getElementById('modal-section-contact');
    const journalIssuesModal = document.getElementById('journal-issues-modal');
    const issuesTableContainer = document.getElementById('issues-table-container');
    const coverModal = document.getElementById('cover-modal');
    const coverImageDisplay = document.getElementById('cover-image-display');

    let allArticles = [];
    let allIssues = [];
    let articlesFetched = false;
    let coverImagePreloaded = false; // فلگ برای پیگیری پیش‌بارگذاری تصویر جلد

    // --- Function to preload cover image ---
    function preloadCoverImage(url) {
        if (!url || url === 'YOUR_LATEST_COVER_IMAGE_URL_HERE.jpg') {
            console.warn('Cover image URL is not set or is a placeholder.');
            coverImagePreloaded = true; // Assume preloaded (or no image to load)
            return Promise.resolve(); // Immediately resolve if no valid URL
        }
        return new Promise((resolve, reject) => {
            const img = new Image();
            img.onload = () => {
                console.log('Cover image preloaded.');
                coverImagePreloaded = true;
                resolve();
            };
            img.onerror = () => {
                console.error('Failed to preload cover image.');
                coverImagePreloaded = true; // Still mark as "attempted"
                reject();
            };
            img.src = url;
        });
    }

    function showPageContent() {
        // صفحه را فقط زمانی نمایش بده که هم مقالات fetch شده باشند و هم تلاش برای پیش‌بارگذاری تصویر جلد انجام شده باشد
        if (articlesFetched && coverImagePreloaded) {
            pageWrapper.classList.add('visible');
            pageWrapper.classList.remove('hidden-until-ready');
            loadingOverlay.style.opacity = '0';
            setTimeout(() => {
                loadingOverlay.style.display = 'none';
                if (showCoverModalOnLoad && latestCoverImageUrl !== 'YOUR_LATEST_COVER_IMAGE_URL_HERE.jpg') {
                    setTimeout(() => { // تاخیر کوتاه برای نمایش مودال جلد
                        toggleCoverModal(true);
                    }, 300); // 0.3 ثانیه تاخیر
                }
            }, 500); // انیمیشن محو شدن لودینگ
        }
    }

    document.addEventListener('DOMContentLoaded', () => {
        articlesContainer.innerHTML = '<p style="text-align:center;">در حال بارگذاری مقالات...</p>';

        const fontLoadPromise = document.fonts && typeof document.fonts.ready === 'object' ?
            document.fonts.ready :
            Promise.resolve();

        // شروع همزمان پیش‌بارگذاری تصویر جلد و بررسی فونت‌ها
        const coverPreloadPromise = preloadCoverImage(latestCoverImageUrl);

        Promise.all([fontLoadPromise, coverPreloadPromise])
            .then(() => {
                console.log('Fonts and Cover Image (attempted) preloading are ready.');
                fetchArticles(); // پس از آماده شدن فونت‌ها و تلاش برای پیش‌بارگذاری جلد، مقالات را fetch کن
            })
            .catch(err => {
                console.warn('Error during initial loading (fonts/cover):', err);
                fetchArticles(); // حتی در صورت خطا، سعی کن مقالات را بارگذاری کنی
            });


        if (coverImageDisplay) {
            coverImageDisplay.addEventListener('click', () => {
                coverImageDisplay.classList.toggle('zoomed');
            });
        }
    });

    function renderArticles(list) {
      articlesContainer.innerHTML = '';
      if (list.length === 0 && allArticles.length > 0) {
        articlesContainer.innerHTML = '<p style="text-align:center;">مقاله‌ای با این مشخصات یافت نشد.</p>';
        return;
      }
      if (list.length === 0 && allArticles.length === 0 && articlesFetched) {
         articlesContainer.innerHTML = '<p style="text-align:center;">هنوز مقاله‌ای برای نمایش وجود ندارد.</p>';
         return;
      }
      list.forEach(article => {
        const card = document.createElement('article');
        card.className = 'article-card';
        card.innerHTML = `
          <h3 class="article-title">${article.title || 'بدون عنوان'}</h3>
          <div class="article-meta">
            ${article.authors ? `<span><strong>نویسندگان:</strong> ${article.authors}</span>` : ''}
            ${article.publication_date ? `<span><strong>تاریخ انتشار:</strong> ${article.publication_date}</span>` : ''}
          </div>
          ${article.abstract ? `<div class="article-abstract">${article.abstract}</div>
          ${article.abstract.length > 200 ? '<span class="read-more-abstract">بیشتر</span><span class="show-less-abstract" style="display:none;">نمایش کمتر</span>' : ''}` : ''}
          ${article.keywords ? `<div class="article-keywords"><strong>کلیدواژه‌ها:</strong> ${article.keywords.split(',').map(kw => `<span>${kw.trim()}</span>`).join('')}</div>` : ''}
          ${article.pdf_link && article.pdf_link !== '#' ? `<a href="${article.pdf_link}" class="download-button" target="_blank" rel="noopener noreferrer">دانلود مقاله</a>` : '<p>فایل مقاله در دسترس نیست</p>'}
        `;
        articlesContainer.appendChild(card);
        const readMoreBtn = card.querySelector('.read-more-abstract');
        const showLessBtn = card.querySelector('.show-less-abstract');
        const abstractDiv = card.querySelector('.article-abstract');
        if (readMoreBtn && abstractDiv) {
          readMoreBtn.addEventListener('click', () => { abstractDiv.classList.add('expanded'); readMoreBtn.style.display = 'none'; if(showLessBtn) showLessBtn.style.display = 'inline-block'; });
        }
        if (showLessBtn && abstractDiv) {
           showLessBtn.addEventListener('click', () => { abstractDiv.classList.remove('expanded'); showLessBtn.style.display = 'none'; if(readMoreBtn) readMoreBtn.style.display = 'inline-block'; });
        }
      });
    }

    function fetchArticles() {
      fetch(`https://docs.google.com/spreadsheets/d/${articlesSheetId}/gviz/tq?tqx=out:json`)
        .then(response => response.text())
        .then(text => {
          const jsonData = JSON.parse(text.substring(text.indexOf('(') + 1, text.lastIndexOf(')')));
          if (jsonData.table && jsonData.table.rows) {
            allArticles = jsonData.table.rows.map(row => ({
              title: row.c[0]?.v || '', authors: row.c[1]?.v || '', abstract: row.c[2]?.v || '',
              keywords: row.c[3]?.v || '', pdf_link: row.c[4]?.v || '#',
              publication_date: row.c[5]?.v ? formatDate(row.c[5].v) : ''
            }));
            renderArticles(allArticles);
            if (allArticles.length === 0) { articlesContainer.innerHTML = '<p style="text-align:center;">هنوز مقاله‌ای برای نمایش وجود ندارد.</p>'; }
          } else {
            articlesContainer.innerHTML = '<p style="text-align:center;">خطا در بارگذاری اطلاعات مقالات. لطفا تنظیمات پایگاه داده را برسی کنید</p>';
            console.error("Error parsing Google Sheet data for articles:", jsonData);
          }
        })
        .catch(error => {
          console.error('Error fetching articles:', error);
          articlesContainer.innerHTML = '<p style="text-align:center;">خطا در برقراری ارتباط برای دریافت مقالات. لطفا اتصال اینترنت خود را بررسی کرده و دوباره تلاش کنید.</p>';
        })
        .finally(() => {
            articlesFetched = true;
            showPageContent(); // تلاش برای نمایش صفحه پس از اتمام fetch مقالات
        });
    }

    function formatDate(dateString) {
        if (typeof dateString === 'string' && dateString.startsWith('Date(')) {
            try {
                const parts = dateString.substring(5, dateString.length - 1).split(',');
                const year = parseInt(parts[0]); const month = parseInt(parts[1]) + 1; const day = parseInt(parts[2]);
                return `${year}/${String(month).padStart(2, '0')}/${String(day).padStart(2, '0')}`;
            } catch (e) { return dateString; }
        }
        return dateString;
    }

    searchInput.addEventListener('input', () => {
      const searchTerm = searchInput.value.trim().toLowerCase();
      const filteredArticles = allArticles.filter(article =>
        (article.title && article.title.toLowerCase().includes(searchTerm)) ||
        (article.authors && article.authors.toLowerCase().includes(searchTerm)) ||
        (article.keywords && article.keywords.toLowerCase().includes(searchTerm)) ||
        (article.abstract && article.abstract.toLowerCase().includes(searchTerm))
      );
      renderArticles(filteredArticles);
    });

    function toggleModal(modalElement, show) {
        if (show) { modalElement.classList.add('visible'); }
        else {
            modalElement.classList.remove('visible');
            if (modalElement === coverModal && coverImageDisplay.classList.contains('zoomed')) {
                coverImageDisplay.classList.remove('zoomed');
            }
        }
    }

    function toggleJournalInfo(show, section = 'about') {
      if (show) {
        modalTitleInfo.textContent = section === 'about' ? 'درباره سالنامه علمی تبیان' : 'اطلاعات تماس';
        modalSectionAbout.style.display = section === 'about' ? 'block' : 'none';
        modalSectionContact.style.display = section === 'contact' ? 'block' : 'none';
      }
      toggleModal(journalInfoModal, show);
    }

    function renderIssues(list) {
        issuesTableContainer.innerHTML = '';
        if (list.length === 0) { issuesTableContainer.innerHTML = '<p style="text-align:center;">هنوز اطلاعات دوره‌ای برای نمایش وجود ندارد.</p>'; return; }
        const table = document.createElement('table');
        table.innerHTML = `
            <thead><tr><th>شماره دوره</th><th>سال انتشار</th><th>دانلود فایل کامل دوره</th></tr></thead>
            <tbody>
            ${list.map(issue => `
                <tr><td>${issue.issue_number || '-'}</td><td>${issue.year || '-'}</td>
                <td style="text-align: center;">
                    ${issue.pdf_link && issue.pdf_link !== '#' ?
                    `<a href="${issue.pdf_link}" class="download-button small" target="_blank" rel="noopener noreferrer">دانلود PDF</a>` :
                    'فایل در دسترس نیست'}
                </td></tr>`).join('')}</tbody>`;
        issuesTableContainer.appendChild(table);
    }

    function fetchIssues() {
        if (allIssues.length > 0) { renderIssues(allIssues); return; }
        issuesTableContainer.innerHTML = '<p style="text-align:center;">در حال بارگذاری اطلاعات دوره‌ها...</p>';
        fetch(`https://docs.google.com/spreadsheets/d/${issuesSheetId}/gviz/tq?tqx=out:json`)
            .then(response => response.text())
            .then(text => {
                const jsonData = JSON.parse(text.substring(text.indexOf('(') + 1, text.lastIndexOf(')')));
                if (jsonData.table && jsonData.table.rows) {
                    allIssues = jsonData.table.rows.map(row => ({
                        issue_number: row.c[0]?.v || '', year: row.c[1]?.v || '', pdf_link: row.c[2]?.v || '#'
                    }));
                    renderIssues(allIssues);
                    if (allIssues.length === 0) { issuesTableContainer.innerHTML = '<p style="text-align:center;">هنوز اطلاعات دوره‌ای برای نمایش وجود ندارد.</p>';}
                } else {
                    issuesTableContainer.innerHTML = '<p style="text-align:center;">خطا در بارگذاری اطلاعات دوره‌ها. لطفا تنظیمات پایگاه داده را بررسی کنید.</p>';
                    console.error("Error parsing Google Sheet data for issues:", jsonData);
                }
            })
            .catch(error => {
                console.error('Error fetching issues:', error);
                issuesTableContainer.innerHTML = '<p style="text-align:center;">خطا در برقراری ارتباط برای دریافت اطلاعات دوره‌ها.</p>';
            });
    }

    function toggleIssuesModal(show) {
      if (show && allIssues.length === 0 && issuesSheetId !== 'PLACEHOLDER_FOR_ISSUES_ID') { fetchIssues(); }
      else if (show) { renderIssues(allIssues); }
      toggleModal(journalIssuesModal, show);
    }

    function toggleCoverModal(show) {
        if (show) {
            if (coverImageDisplay && latestCoverImageUrl && latestCoverImageUrl !== 'YOUR_LATEST_COVER_IMAGE_URL_HERE.jpg') {
                coverImageDisplay.src = latestCoverImageUrl;
            } else if (coverImageDisplay) {
                coverImageDisplay.alt = "تصویر جلد در دسترس نیست";
                coverImageDisplay.src = ""; // برای جلوگیری از نمایش آیکون تصویر شکسته
                // اگر URL تصویر جلد معتبر نیست، مودال جلد اصلا نمایش داده نشود
                if (!latestCoverImageUrl || latestCoverImageUrl === 'YOUR_LATEST_COVER_IMAGE_URL_HERE.jpg') {
                    console.warn("Cover image URL is invalid, not showing cover modal.");
                    return; // از نمایش مودال جلوگیری کن
                }
            }
        }
        toggleModal(coverModal, show);
    }
  </script>

</body>
</html>
